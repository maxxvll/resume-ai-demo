<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AIç®€å†åŠ©æ‰‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen p-8">
    <div class="max-w-4xl mx-auto">
      <div class="text-center mb-10">
        <div
          class="inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl shadow-lg mb-4"
        >
          <span class="text-3xl">ğŸš€</span>
        </div>
        <h1 class="text-4xl font-bold text-slate-800 mb-2">AI ç®€å†åŠ©æ‰‹</h1>
        <p class="text-slate-500">åŸºäºé˜¿é‡Œäº‘ Serverless + é€šä¹‰åƒé—®</p>
        <div
          id="serviceStatus"
          class="mt-4 inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-full text-sm font-medium"
        >
          <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
          åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸
        </div>
      </div>

      <!-- è¾“å…¥åŒºåŸŸ -->
      <div
        class="bg-white rounded-2xl shadow-xl p-8 mb-8 border border-slate-100"
      >
        <div class="mb-6">
          <label class="block text-sm font-bold text-slate-700 mb-2"
            >ğŸ“„ ä¸Šä¼ ç®€å† (PDF)</label
          >
          <div class="flex items-center justify-center w-full">
            <label
              for="pdfInput"
              class="flex flex-col items-center justify-center w-full h-32 border-2 border-slate-300 border-dashed rounded-xl cursor-pointer bg-slate-50 hover:bg-slate-100 transition"
            >
              <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <svg
                  class="w-8 h-8 mb-4 text-slate-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"
                  ></path>
                </svg>
                <p class="mb-2 text-sm text-slate-500">
                  <span class="font-semibold">ç‚¹å‡»ä¸Šä¼ </span> æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ
                </p>
                <p class="text-xs text-slate-400">æ”¯æŒ PDF æ ¼å¼</p>
              </div>
              <input
                id="pdfInput"
                type="file"
                class="hidden"
                accept="application/pdf"
              />
            </label>
          </div>
          <p
            id="fileName"
            class="mt-2 text-sm text-blue-600 font-medium hidden"
          ></p>
        </div>

        <div class="mb-8">
          <label class="block text-sm font-bold text-slate-700 mb-2"
            >ğŸ’¼ å²—ä½è¦æ±‚ (å¯é€‰)</label
          >
          <textarea
            id="jobDesc"
            rows="3"
            class="w-full p-4 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition"
            placeholder="ä¾‹å¦‚ï¼šè¦æ±‚3å¹´ä»¥ä¸ŠPythonç»éªŒï¼Œç†Ÿæ‚‰FastAPIï¼Œæœ‰é˜¿é‡Œäº‘å¼€å‘ç»éªŒ..."
          ></textarea>
        </div>

        <button
          onclick="handleAnalyze()"
          id="submitBtn"
          class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition duration-200 flex items-center justify-center gap-3"
        >
          <span id="btnText">å¼€å§‹è§£æ</span>
          <svg
            id="loadingIcon"
            class="hidden animate-spin h-5 w-5 text-white"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
          >
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            ></path>
          </svg>
        </button>
      </div>

      <!-- ç»“æœåŒºåŸŸ -->
      <div id="resultArea" class="hidden">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div
            class="bg-white p-6 rounded-2xl shadow-lg text-center border-t-4 border-blue-500 transform hover:scale-105 transition"
          >
            <div class="text-sm text-slate-500 mb-1">å€™é€‰äºº</div>
            <div class="text-2xl font-bold text-slate-800" id="nameDisplay">
              --
            </div>
          </div>
          <div
            class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-purple-500 transform hover:scale-105 transition"
          >
            <div class="text-sm text-slate-500 mb-1">è”ç³»ç”µè¯</div>
            <div class="text-xl font-bold text-slate-800" id="phoneDisplay">
              --
            </div>
          </div>
          <div
            class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-green-500 transform hover:scale-105 transition"
          >
            <div class="text-sm text-slate-500 mb-1">é‚®ç®±</div>
            <div class="text-lg font-bold text-slate-800" id="emailDisplay">
              --
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-lg p-8">
          <h3 class="font-bold text-lg mb-6 flex items-center gap-3">
            <span class="w-1.5 h-6 bg-blue-600 rounded-full"></span>
            å®Œæ•´è§£æç»“æœ
          </h3>
          <pre
            id="jsonDisplay"
            class="bg-slate-900 text-green-400 p-6 rounded-xl overflow-x-auto text-sm leading-relaxed"
          ></pre>
        </div>
      </div>
    </div>

    <script>
      // ã€é‡è¦ã€‘æ›¿æ¢ä¸ºä½ çš„é˜¿é‡Œäº‘åç«¯æ¥å£åœ°å€
      const API_URL =
        'https://resume-parser-kpfnsudlzw.cn-hangzhou.fcapp.run/analyze'

      // æ–‡ä»¶é€‰æ‹©ç›‘å¬
      document
        .getElementById('pdfInput')
        .addEventListener('change', function (e) {
          if (e.target.files.length > 0) {
            document.getElementById('fileName').textContent =
              'å·²é€‰æ‹©: ' + e.target.files[0].name
            document.getElementById('fileName').classList.remove('hidden')
          }
        })

      // è§£æå‡½æ•°
      async function handleAnalyze() {
        const fileInput = document.getElementById('pdfInput')
        const jobDesc = document.getElementById('jobDesc').value
        const btnText = document.getElementById('btnText')
        const loadingIcon = document.getElementById('loadingIcon')
        const resultArea = document.getElementById('resultArea')

        // æ ¡éªŒæ–‡ä»¶
        if (!fileInput.files[0]) {
          alert('è¯·å…ˆé€‰æ‹©ç®€å†æ–‡ä»¶ï¼')
          return
        }

        // æ›´æ–°UIçŠ¶æ€
        btnText.innerText = 'AI åˆ†æä¸­...'
        loadingIcon.classList.remove('hidden')
        resultArea.classList.add('hidden')

        // æ„å»ºè¡¨å•æ•°æ®
        const formData = new FormData()
        formData.append('resume', fileInput.files[0])
        formData.append('job_description', jobDesc)

        try {
          // è°ƒç”¨åç«¯æ¥å£
          const response = await fetch(API_URL, {
            method: 'POST',
            body: formData,
          })

          const result = await response.json()

          if (result.success) {
            // å¡«å……ç»“æœ
            const data = result.data
            document.getElementById('nameDisplay').innerText =
              data.name || 'æœªçŸ¥'
            document.getElementById('phoneDisplay').innerText =
              data.phone || 'æœªçŸ¥'
            document.getElementById('emailDisplay').innerText =
              data.email || 'æœªçŸ¥'
            document.getElementById('jsonDisplay').innerText = JSON.stringify(
              data,
              null,
              2,
            )
            resultArea.classList.remove('hidden')
          } else {
            alert('è§£æå¤±è´¥ï¼š' + result.message)
          }
        } catch (err) {
          console.error(err)
          alert('è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸')
        } finally {
          // æ¢å¤UIçŠ¶æ€
          btnText.innerText = 'å¼€å§‹è§£æ'
          loadingIcon.classList.add('hidden')
        }
      }
    </script>
  </body>
</html>
